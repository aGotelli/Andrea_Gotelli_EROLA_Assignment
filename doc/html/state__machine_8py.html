<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EROLA first assignment: /home/andrea/git/EROLA_first_assignment_AG/state_machine/scripts/state_machine.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="goat.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EROLA first assignment
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e2bf0c5ff5f4a005c17bd42e100e3fe4.html">state_machine</a></li><li class="navelem"><a class="el" href="dir_14e1b7d3445cea88d2f86dfc1b27278a.html">scripts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">state_machine.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the state machine for the high level control of this application.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstate__machine_1_1Move.html">state_machine.Move</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class defines the state of the state machine corresponding to the robot randomly moving.  <a href="classstate__machine_1_1Move.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstate__machine_1_1Rest.html">state_machine.Rest</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class defines the state of the state machine corresponding to the robot sleeping.  <a href="classstate__machine_1_1Rest.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstate__machine_1_1Play.html">state_machine.Play</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class defines the state of the state machine corresponding to the robot playing.  <a href="classstate__machine_1_1Play.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae56b2385e699f4749a132fe2d2101abd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#ae56b2385e699f4749a132fe2d2101abd">state_machine.reachPosition</a> (pose, info)</td></tr>
<tr class="memdesc:ae56b2385e699f4749a132fe2d2101abd"><td class="mdescLeft">&#160;</td><td class="mdescRight">reachPosition calls the service /MoveToPosition and prints out a string.  <a href="state__machine_8py.html#ae56b2385e699f4749a132fe2d2101abd">More...</a><br /></td></tr>
<tr class="separator:ae56b2385e699f4749a132fe2d2101abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668eb6a693990b19ee61ef95b1b368bc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#a668eb6a693990b19ee61ef95b1b368bc">state_machine.isTired</a> (fatigue_level)</td></tr>
<tr class="memdesc:a668eb6a693990b19ee61ef95b1b368bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">isTired check the level of fatigue to establish if the robot is "tired"  <a href="state__machine_8py.html#a668eb6a693990b19ee61ef95b1b368bc">More...</a><br /></td></tr>
<tr class="separator:a668eb6a693990b19ee61ef95b1b368bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afc7a5f738ac8cd5ddef097d6e22ea12f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#afc7a5f738ac8cd5ddef097d6e22ea12f">state_machine.width</a> = 0</td></tr>
<tr class="memdesc:afc7a5f738ac8cd5ddef097d6e22ea12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the width of the discretized world.  <a href="state__machine_8py.html#afc7a5f738ac8cd5ddef097d6e22ea12f">More...</a><br /></td></tr>
<tr class="separator:afc7a5f738ac8cd5ddef097d6e22ea12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e05e6d2f8f284f7eb89641dedffde1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#a10e05e6d2f8f284f7eb89641dedffde1">state_machine.height</a> = 0</td></tr>
<tr class="memdesc:a10e05e6d2f8f284f7eb89641dedffde1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the height of the discretized world.  <a href="state__machine_8py.html#a10e05e6d2f8f284f7eb89641dedffde1">More...</a><br /></td></tr>
<tr class="separator:a10e05e6d2f8f284f7eb89641dedffde1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc2278dd1727189bf93c4d1bc0799cd"><td class="memItemLeft" align="right" valign="top"><a id="a9bc2278dd1727189bf93c4d1bc0799cd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#a9bc2278dd1727189bf93c4d1bc0799cd">state_machine.sleep_station</a> = Pose()</td></tr>
<tr class="memdesc:a9bc2278dd1727189bf93c4d1bc0799cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the position where the robot goes to sleep, it is a paremter defined by the user. <br /></td></tr>
<tr class="separator:a9bc2278dd1727189bf93c4d1bc0799cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e2ad707abe3a40d668b8f203a0cc77"><td class="memItemLeft" align="right" valign="top"><a id="a38e2ad707abe3a40d668b8f203a0cc77"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#a38e2ad707abe3a40d668b8f203a0cc77">state_machine.fatigue_threshold</a> = 0</td></tr>
<tr class="memdesc:a38e2ad707abe3a40d668b8f203a0cc77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the maximum level of fatigue the robot can andle before going to sleep. <br /></td></tr>
<tr class="separator:a38e2ad707abe3a40d668b8f203a0cc77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cab6b7ac8d2fa983b8a781699559eb2"><td class="memItemLeft" align="right" valign="top"><a id="a0cab6b7ac8d2fa983b8a781699559eb2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8py.html#a0cab6b7ac8d2fa983b8a781699559eb2">state_machine.move_to_pos_client</a> = rospy.ServiceProxy('/MoveToPosition', MoveTo)</td></tr>
<tr class="memdesc:a0cab6b7ac8d2fa983b8a781699559eb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Service client defined as global to be acessible outside the main. <br /></td></tr>
<tr class="separator:a0cab6b7ac8d2fa983b8a781699559eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ffbe3d9e69ff56cc9d640c6de7b832"><td class="memItemLeft" align="right" valign="top"><a id="a81ffbe3d9e69ff56cc9d640c6de7b832"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.x</b></td></tr>
<tr class="separator:a81ffbe3d9e69ff56cc9d640c6de7b832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5c2b3d31a0cff21276a25d744d29c6"><td class="memItemLeft" align="right" valign="top"><a id="aec5c2b3d31a0cff21276a25d744d29c6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.y</b></td></tr>
<tr class="separator:aec5c2b3d31a0cff21276a25d744d29c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6793c4913a1241bddf256328c9a01028"><td class="memItemLeft" align="right" valign="top"><a id="a6793c4913a1241bddf256328c9a01028"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.sm</b> = smach.StateMachine(outcomes=['behavior_interface'])</td></tr>
<tr class="separator:a6793c4913a1241bddf256328c9a01028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9dc6e28b0078eeffd6aedb36ab3e52a"><td class="memItemLeft" align="right" valign="top"><a id="aa9dc6e28b0078eeffd6aedb36ab3e52a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.fatigue_level</b></td></tr>
<tr class="separator:aa9dc6e28b0078eeffd6aedb36ab3e52a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f1c3f8a262ac7b600fa7ee2a9d56c2"><td class="memItemLeft" align="right" valign="top"><a id="a37f1c3f8a262ac7b600fa7ee2a9d56c2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.person</b></td></tr>
<tr class="separator:a37f1c3f8a262ac7b600fa7ee2a9d56c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372490be06dbd069bfafaa476a4f9f0b"><td class="memItemLeft" align="right" valign="top"><a id="a372490be06dbd069bfafaa476a4f9f0b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.transitions</b></td></tr>
<tr class="separator:a372490be06dbd069bfafaa476a4f9f0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79821721f66b54a385a27e6c1004f57c"><td class="memItemLeft" align="right" valign="top"><a id="a79821721f66b54a385a27e6c1004f57c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.remapping</b></td></tr>
<tr class="separator:a79821721f66b54a385a27e6c1004f57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c431850437f844cabf1123287e44478"><td class="memItemLeft" align="right" valign="top"><a id="a0c431850437f844cabf1123287e44478"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.sis</b> = smach_ros.IntrospectionServer('robot_behavior_state_machine', sm, '/SM_ROOT')</td></tr>
<tr class="separator:a0c431850437f844cabf1123287e44478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbf2f3b4f08f91ac415d0c496d674e03"><td class="memItemLeft" align="right" valign="top"><a id="acbf2f3b4f08f91ac415d0c496d674e03"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine.outcome</b> = sm.execute()</td></tr>
<tr class="separator:acbf2f3b4f08f91ac415d0c496d674e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the state machine for the high level control of this application. </p>
<dl class="section author"><dt>Author</dt><dd>Andrea Gotelli </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22/10/2020</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">world_width</td><td>the width of the discretized world </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">world_height</td><td>the height of the discretized world </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sleep_x_coord</td><td>is the x coordinate of the position where the robot sleeps </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sleep_y_coord</td><td>is the y coordinate of the position where the robot sleeps</td></tr>
  </table>
  </dd>
</dl>
<p>Subscribes to: <br  />
 ° /PlayWithRobot topic where the person publishes the given play command</p>
<p>Publishes to: <br  />
 ° [None]</p>
<p>Service : <br  />
 ° /Gesture as client, it waits for the gesture to come.</p>
<p>° /MoveToPosition as cliet, ask to simulate the motion to the given position</p>
<p>Description :</p>
<p>This file uses smach libraries to generate a state machine, which is used to control the behaviors of the robot. Specifically, the state machine defines the transition from a state to another using the interface provided by smach.</p>
<p>This file could be considered the head of the simulation an its more complex and important part.</p>
<p>The states are defined in the respective classes, and the transistions are automatically performed by the state machine from the smach libraries. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a668eb6a693990b19ee61ef95b1b368bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668eb6a693990b19ee61ef95b1b368bc">&#9670;&nbsp;</a></span>isTired()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def state_machine.isTired </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fatigue_level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>isTired check the level of fatigue to establish if the robot is "tired" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>[integer] is the current level of fatigue of the robot. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a boolen. True if the robot is "tired" false elsewhere.</dd></dl>
<p>This function compares the level of fatigue with and hard threshold which is a parameter eccessible for the user. </p>

</div>
</div>
<a id="ae56b2385e699f4749a132fe2d2101abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae56b2385e699f4749a132fe2d2101abd">&#9670;&nbsp;</a></span>reachPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def state_machine.reachPosition </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reachPosition calls the service /MoveToPosition and prints out a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pose</td><td>[geometry_msgs/Pose] is the position the robot should reach. </td></tr>
    <tr><td class="paramname">info</td><td>[string] is information to display when approaching the position.</td></tr>
  </table>
  </dd>
</dl>
<p>This function calls the service /MoveToPosition and prints out a string. Its usage should preferred insted of pasting the same lines of code around. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a10e05e6d2f8f284f7eb89641dedffde1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10e05e6d2f8f284f7eb89641dedffde1">&#9670;&nbsp;</a></span>height</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state_machine.height = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define the height of the discretized world. </p>
<p>It is a parameter defined by the user. </p>

</div>
</div>
<a id="afc7a5f738ac8cd5ddef097d6e22ea12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7a5f738ac8cd5ddef097d6e22ea12f">&#9670;&nbsp;</a></span>width</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state_machine.width = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define the width of the discretized world. </p>
<p><b>main</b> intializes the ros node and the smach state machine</p>
<p>It is a parameter defined by the user.</p>
<p>This functions does nothing more than initializing the node and the state machine. It also retrieves the parameters from the ros parameters server and the user data exchanged among the state machine states. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
